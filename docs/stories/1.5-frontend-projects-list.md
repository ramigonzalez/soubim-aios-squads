# Story 1.5: Frontend Projects List Page

**Story ID:** 1.5
**Assigned to:** @dev
**Sprint:** Sprint 1 (Week 1)
**Status:** Draft
**Estimation:** 5 story points (1.5 days)

---

## Summary

Implement projects list page with API integration, React Query caching, and navigation to project detail views. Display project cards with metadata.

---

## Acceptance Criteria

- [ ] Projects page functional
  - [ ] Fetches projects from `/api/projects`
  - [ ] Displays list of project cards
  - [ ] Shows project name, description, member count, decision count
  - [ ] Pagination working (next/prev)
- [ ] React Query integration
  - [ ] useQuery hook for projects
  - [ ] Caching (5min stale time)
  - [ ] Automatic refetch on stale
  - [ ] Loading state displayed
  - [ ] Error state displayed
- [ ] Navigation
  - [ ] Click project card → navigate to `/projects/{id}`
  - [ ] Breadcrumb showing current location
  - [ ] Logout button visible
- [ ] Styling
  - [ ] Grid layout (responsive)
  - [ ] Professional card design (Tailwind)
  - [ ] Loading spinner
  - [ ] Error message styling
  - [ ] Mobile responsive
- [ ] Tests passing: `npm test` (80%+ coverage)

---

## Tasks

### Task 1: Implement useQuery Hook (1 day)
- [ ] Update `src/hooks/useDecisions.ts` (or create useProjects.ts)
  - [ ] Create useProjects() hook
  - [ ] Call api.get('/projects') with limit, offset
  - [ ] Return useQuery result with projects, isLoading, error, refetch
  - [ ] Handle pagination parameters
- [ ] Alternative: Use hook directly in component
  - [ ] useQuery('projects', () => api.get('/projects'))
- [ ] Test hook independently
  - [ ] Mock API responses
  - [ ] Test loading state
  - [ ] Test success response
  - [ ] Test error handling

### Task 2: Enhance Projects Component
- [ ] Update `src/pages/Projects.tsx`
  - [ ] Remove hardcoded data
  - [ ] Add useQuery hook
  - [ ] Call api.get('/projects')
  - [ ] Handle loading state (spinner)
  - [ ] Handle error state (error message)
  - [ ] Display project list (grid layout)
  - [ ] Support pagination (limit, offset)
  - [ ] Click handler → navigate to `/projects/{id}`
- [ ] Test manually
  - [ ] Page loads
  - [ ] Projects display
  - [ ] Loading spinner shows
  - [ ] Error handling works

### Task 3: Create Project Card Component
- [ ] Create `src/components/common/ProjectCard.tsx`
  - [ ] Display project name
  - [ ] Display description
  - [ ] Display member count
  - [ ] Display decision count
  - [ ] Display created_at formatted
  - [ ] Hover effect
  - [ ] onClick handler
- [ ] Styling
  - [ ] White card with shadow
  - [ ] Responsive grid
  - [ ] Readable text hierarchy
  - [ ] Icons for stats

### Task 4: Add Navigation & Layout
- [ ] Create `src/components/common/Navigation.tsx`
  - [ ] Display project title (when applicable)
  - [ ] Logout button
  - [ ] Breadcrumb navigation
  - [ ] Responsive menu
- [ ] Update `src/App.tsx`
  - [ ] Add Navigation to layout
  - [ ] Wrap pages with layout
- [ ] Add breadcrumb
  - [ ] Home > Projects > [Project Name]
  - [ ] Links to navigate

### Task 5: Write Tests
- [ ] Create `src/tests/components/ProjectCard.test.tsx`
  - [ ] Test renders project info
  - [ ] Test onClick handler
- [ ] Create `src/tests/pages/Projects.test.tsx`
  - [ ] Test loads projects
  - [ ] Test renders cards
  - [ ] Test error handling
  - [ ] Test loading state
- [ ] Create `src/tests/hooks/useProjects.test.ts`
  - [ ] Test API call
  - [ ] Test caching
  - [ ] Test pagination
- [ ] Min 80% coverage

---

## Dev Notes

**Backend Required:**
- Story 1.3 (Project endpoints) must be running
- Backend returning ProjectsResponse with pagination

**API Contract:**
```json
GET /api/projects?limit=50&offset=0

Response (200):
{
  "projects": [
    {
      "id": "uuid",
      "name": "Residential Tower Alpha",
      "description": "50-floor tower in downtown",
      "created_at": "2026-01-15T10:00:00Z",
      "member_count": 8,
      "decision_count": 127,
      "latest_decision": "2026-02-07T14:30:00Z"
    }
  ],
  "total": 3,
  "limit": 50,
  "offset": 0
}
```

**React Query Setup:**
- Stale time: 5 minutes
- Cache time: 10 minutes
- Retry on failure: 3 times
- Refetch on window focus: enabled

**Grid Layout:**
```
lg: 3 columns
md: 2 columns
sm: 1 column
```

---

## File List

**Modified/Created:**
- `src/pages/Projects.tsx` (modify) - Implement with API
- `src/hooks/useProjects.ts` (new) - React Query hook
- `src/components/common/ProjectCard.tsx` (new) - Card component
- `src/components/common/Navigation.tsx` (new) - Nav bar
- `src/tests/pages/Projects.test.tsx` (new) - Component tests
- `src/tests/hooks/useProjects.test.ts` (new) - Hook tests
- `src/tests/components/ProjectCard.test.tsx` (new) - Card tests

---

## Completion Notes

_Fill in after completing the story_

- **Date Completed:**
- **Actual Points:**
- **Issues Encountered:**
- **Lessons Learned:**

---

## Change Log

| Date | Change |
|------|--------|
| 2026-02-07 | Created story |

---

**Related Stories:** 1.3 (Projects API), 1.4 (Login page)
**Blocked By:** 1.3, 1.4
**Blocks:** 2.1 (Project detail page)
