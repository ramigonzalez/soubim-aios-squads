# Story 9.5: Rename & Navigation Update

**Story ID:** 9.5
**Epic:** E9 — Project History Enhancement
**Assigned to:** @dev
**Sprint:** Sprint 5 (Week 8)
**Status:** Draft
**Estimation:** 3 story points (1 day)
**UX Guidelines:** `docs/ux/UX-UI-GUIDELINES.md` (Section 7.1: Navigation)

---

## Summary

Rename "Timeline" to "Project History" throughout the UI and update the Project Detail page to show a tab toggle between "Milestone Timeline" and "Project History." Default view is Milestone Timeline if project has stages defined, otherwise Project History. Tab state persists in URL hash. Update navigation breadcrumbs and all user-facing text references.

---

## Acceptance Criteria

### Rename "Timeline" → "Project History"
- [ ] All visible UI text referring to "Timeline" changed to "Project History"
- [ ] Locations to update:
  - [ ] Project Detail page heading/tab label
  - [ ] Navigation breadcrumb
  - [ ] Empty state messages
  - [ ] Filter bar label/heading (if any)
  - [ ] Loading state text
  - [ ] Error state text
  - [ ] Any aria-labels referencing "Timeline"
- [ ] **Code internals NOT renamed** — component file names, hook names, and internal variables keep "Timeline" for backward compatibility (rename is UI-only)
- [ ] `Milestone Timeline` label remains as-is (it is already correct)

### Tab Toggle
- [ ] Project Detail page shows tab toggle: **"Milestone Timeline"** | **"Project History"**
- [ ] Tab styling: segmented control (consistent with GroupingToggle pattern)
  ```
  inline-flex rounded-lg border border-gray-200 p-0.5 bg-gray-100
  ```
- [ ] Active tab: `bg-white rounded-md shadow-sm text-gray-900 font-medium`
- [ ] Inactive tab: `text-gray-500 hover:text-gray-700`
- [ ] Tab position: above filter bar, below project title/breadcrumb
- [ ] Icons on tabs (optional): `Star` for Milestone Timeline, `Clock` for Project History

### Default View Logic
- [ ] If project has stages (from Story 6.1): default to "Milestone Timeline" tab
- [ ] If project has NO stages: default to "Project History" tab
- [ ] Logic: `const defaultTab = stages.length > 0 ? 'milestones' : 'history'`

### URL Hash Persistence
- [ ] Active tab encoded in URL hash: `#milestones` or `#history`
- [ ] On page load: read hash → set active tab
- [ ] On tab switch: update hash without page reload
- [ ] Deep linking: `/projects/123#milestones` opens Milestone Timeline tab
- [ ] Deep linking: `/projects/123#history` opens Project History tab
- [ ] No hash: use default logic (stages → milestones, no stages → history)

### Breadcrumb Update
- [ ] Breadcrumb pattern: `Projects > {Project Name} > {Current Tab}`
- [ ] Current Tab shows: "Milestone Timeline" or "Project History"
- [ ] Breadcrumb updates when switching tabs

### Filter State Isolation
- [ ] Milestone Timeline and Project History have independent filter states
- [ ] Switching tabs does not reset the other tab's filters
- [ ] URL params for filters are tab-scoped (milestone filters separate from history filters)

---

## Tasks

### Task 1: Update Project Detail Page — Tab Toggle (0.5 days)

1. **Modify `src/pages/ProjectDetail.tsx`**
   ```typescript
   type ViewTab = 'milestones' | 'history'

   function ProjectDetail() {
     const { projectId } = useParams()
     const { data: stages } = useProjectStages(projectId!)

     // Tab state from URL hash
     const [activeTab, setActiveTab] = useState<ViewTab>(() => {
       const hash = window.location.hash.slice(1)
       if (hash === 'milestones' || hash === 'history') return hash
       return (stages?.length ?? 0) > 0 ? 'milestones' : 'history'
     })

     // Update hash on tab change
     const handleTabChange = (tab: ViewTab) => {
       setActiveTab(tab)
       window.location.hash = tab
     }

     return (
       <div>
         {/* Breadcrumb */}
         <nav className="text-sm text-gray-500 mb-4">
           <a href="/projects" className="hover:text-blue-600">Projects</a>
           <span className="mx-2">›</span>
           <span>{project.title}</span>
           <span className="mx-2">›</span>
           <span className="text-gray-900">
             {activeTab === 'milestones' ? 'Milestone Timeline' : 'Project History'}
           </span>
         </nav>

         {/* Tab Toggle */}
         <div className="inline-flex rounded-lg border border-gray-200 p-0.5 bg-gray-100 mb-4">
           <button
             className={cn(
               'px-4 py-1.5 text-sm rounded-md transition-colors',
               activeTab === 'milestones'
                 ? 'bg-white shadow-sm text-gray-900 font-medium'
                 : 'text-gray-500 hover:text-gray-700'
             )}
             onClick={() => handleTabChange('milestones')}
           >
             <Star className="w-4 h-4 inline mr-1.5" />
             Milestone Timeline
           </button>
           <button
             className={cn(
               'px-4 py-1.5 text-sm rounded-md transition-colors',
               activeTab === 'history'
                 ? 'bg-white shadow-sm text-gray-900 font-medium'
                 : 'text-gray-500 hover:text-gray-700'
             )}
             onClick={() => handleTabChange('history')}
           >
             <Clock className="w-4 h-4 inline mr-1.5" />
             Project History
           </button>
         </div>

         {/* Content */}
         {activeTab === 'milestones' ? (
           <MilestoneTimeline projectId={projectId!} />
         ) : (
           <Timeline projectId={projectId!} />
         )}
       </div>
     )
   }
   ```

### Task 2: Update Text References (0.25 days)

1. **Search all frontend source for "Timeline" in user-facing strings**
   - Update empty state: "No decisions yet" → "No project items yet. Items will appear as meetings are processed."
   - Update loading: "Loading timeline..." → "Loading project history..."
   - Update error: "Failed to load timeline" → "Failed to load project history"
   - Update aria-labels referencing "timeline" → "project history"

2. **Files to check:**
   - `src/components/organisms/Timeline.tsx` — internal comment OK, user-facing strings updated
   - `src/pages/ProjectDetail.tsx` — heading, breadcrumb
   - `src/components/common/Navigation.tsx` — any nav link text

### Task 3: Update Navigation (0.25 days)

1. **Modify `src/components/common/Navigation.tsx`** (if applicable)
   - If there's a direct "Timeline" link, rename to "Project History"
   - Ensure navigation links to correct project detail with appropriate hash

### Task 4: Write Tests (0.25 days)

1. **Update `src/tests/pages/ProjectDetail.test.tsx`**
   - Tab toggle renders with both options
   - Default tab is "milestones" when stages exist
   - Default tab is "history" when no stages
   - URL hash updates on tab switch
   - URL hash restores tab on page load
   - Breadcrumb shows correct tab name
   - No "Timeline" text visible in UI (only "Project History" and "Milestone Timeline")

---

## Dev Notes

### What Gets Renamed vs What Doesn't

| Layer | Renamed? | Rationale |
|-------|----------|-----------|
| User-facing text | ✅ YES | "Project History" everywhere the user sees |
| Component file names | ❌ NO | `Timeline.tsx` stays — breaking rename not worth churn |
| Hook names | ❌ NO | `useDecisions` already renamed to `useProjectItems` in 5.3 |
| Store names | ❌ NO | Internal naming doesn't affect UX |
| Test files | ❌ NO | Test file names match component names |
| Route paths | ⚠️ PARTIAL | URL hash uses `#history` (new), route path `/projects/:id` stays |

### Tab State Architecture

```
URL Hash: #milestones | #history
    ↕ (read on mount, write on change)
Component State: activeTab: 'milestones' | 'history'
    ↓
Conditional Render:
  milestones → <MilestoneTimeline /> + MilestoneFilterBar
  history → <Timeline /> + FilterBar
```

---

## File List

**New Files:**
- None (all modifications)

**Modified Files:**
- `src/pages/ProjectDetail.tsx` — Tab toggle, breadcrumb, default view logic, URL hash
- `src/components/organisms/Timeline.tsx` — User-facing text strings updated
- `src/components/common/Navigation.tsx` — Nav link text update (if applicable)
- `src/tests/pages/ProjectDetail.test.tsx` — Tab toggle and rename tests

---

## Testing Strategy

### Unit Tests
```
- ✅ Tab toggle renders "Milestone Timeline" and "Project History"
- ✅ Default tab logic: stages → milestones, no stages → history
- ✅ URL hash persistence: set and restore
- ✅ Breadcrumb updates on tab switch
- ✅ No "Timeline" (standalone) text in rendered UI
- ✅ Deep linking with hash works
```

### Manual Verification
- Search codebase for user-facing "Timeline" strings (exclude Milestone Timeline)
- Verify all aria-labels updated

### Coverage Target: 80%+

---

## Change Log

| Date | Change |
|------|--------|
| 2026-02-20 | Created story |

---

**Related Stories:** 8.1 (MilestoneTimeline component), 9.2 (Dense Rows Timeline), 9.4 (filter bar)
**Blocked By:** 9.2 (Dense Rows layout for Project History tab), 8.1 (Milestone Timeline component)
**Blocks:** None (final E9 story)
