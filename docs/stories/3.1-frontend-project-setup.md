# Story 3.1: Frontend Project Setup

**Story ID:** 3.1
**Assigned to:** @dev
**Sprint:** Sprint 4 (Week 6)
**Status:** Draft
**Estimation:** 5 story points (2 days)

---

## Summary

Scaffold a complete React + TypeScript frontend project with Vite, Tailwind CSS, React Query, Zustand, and routing. Establish project structure, build tooling, and development workflow for the DecisionLog dashboard.

---

## Acceptance Criteria

- [ ] React 18 + TypeScript project created via Vite
- [ ] Project structure organized:
  - [ ] `src/components/` - Reusable UI components
  - [ ] `src/pages/` - Page components
  - [ ] `src/hooks/` - Custom React hooks
  - [ ] `src/services/` - API service layer
  - [ ] `src/store/` - Zustand state management
  - [ ] `src/types/` - TypeScript type definitions
- [ ] Dependencies installed:
  - [ ] React Router v6
  - [ ] React Query (TanStack Query)
  - [ ] Zustand
  - [ ] Tailwind CSS + Shadcn/ui
  - [ ] Axios
- [ ] Build process working:
  - [ ] `npm run dev` - Development server
  - [ ] `npm run build` - Production build
  - [ ] `npm run typecheck` - TypeScript validation
  - [ ] `npm run lint` - ESLint checks
- [ ] Environment variables configured (`.env.example`)
- [ ] Tests passing: `npm run test` (Vitest setup)

---

## Tasks

### Task 1: Initialize Vite + React + TypeScript Project (0.5 days)

1. **Create project**
   ```bash
   npm create vite@latest decision-log-frontend -- --template react-ts
   cd decision-log-frontend
   npm install
   ```

2. **Verify installation**
   ```bash
   npm run dev  # Should start on http://localhost:5173
   ```

3. **Update `tsconfig.json` for strict mode**
   ```json
   {
     "compilerOptions": {
       "target": "ES2020",
       "useDefineForClassFields": true,
       "lib": ["ES2020", "DOM", "DOM.Iterable"],
       "module": "ESNext",
       "skipLibCheck": true,
       "strict": true,
       "noUnusedLocals": true,
       "noUnusedParameters": true,
       "noFallthroughCasesInSwitch": true,
       "moduleResolution": "bundler",
       "allowImportingTsExtensions": true,
       "resolveJsonModule": true,
       "isolatedModules": true,
       "noEmit": true,
       "jsx": "react-jsx",
       "baseUrl": ".",
       "paths": {
         "@/*": ["./src/*"]
       }
     },
     "include": ["src"],
     "references": [{ "path": "./tsconfig.node.json" }]
   }
   ```

### Task 2: Install and Configure Dependencies (0.75 days)

1. **Install core dependencies**
   ```bash
   npm install react-router-dom
   npm install @tanstack/react-query
   npm install zustand
   npm install axios
   npm install date-fns  # Date formatting
   ```

2. **Install Tailwind CSS + Shadcn/ui**
   ```bash
   npm install -D tailwindcss postcss autoprefixer
   npx tailwindcss init -p

   # Install Shadcn/ui
   npx shadcn-ui@latest init
   ```

3. **Configure Tailwind (`tailwind.config.ts`)**
   ```typescript
   import type { Config } from 'tailwindcss'

   export default {
     darkMode: ["class"],
     content: [
       './pages/**/*.{ts,tsx}',
       './components/**/*.{ts,tsx}',
       './app/**/*.{ts,tsx}',
       './src/**/*.{ts,tsx}',
     ],
     theme: {
       extend: {
         colors: {
           border: "hsl(var(--border))",
           background: "hsl(var(--background))",
           foreground: "hsl(var(--foreground))",
           // Discipline colors
           architecture: '#3B82F6',
           mep: '#F97316',
           landscape: '#10B981',
           structural: '#8B5CF6',
           electrical: '#F59E0B',
           plumbing: '#06B6D4',
         },
       },
     },
     plugins: [require("tailwindcss-animate")],
   } satisfies Config
   ```

4. **Install dev dependencies**
   ```bash
   npm install -D @types/node
   npm install -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin
   npm install -D vitest @testing-library/react @testing-library/jest-dom
   ```

### Task 3: Create Project Structure (0.5 days)

1. **Create directory structure**
   ```bash
   mkdir -p src/components
   mkdir -p src/pages
   mkdir -p src/hooks
   mkdir -p src/services
   mkdir -p src/store
   mkdir -p src/types
   mkdir -p src/lib
   ```

2. **Create base TypeScript types (`src/types/index.ts`)**
   ```typescript
   export interface User {
     id: string
     email: string
     name: string
     role: 'director' | 'architect' | 'client'
   }

   export interface Project {
     id: string
     name: string
     description: string
     created_at: string
     member_count: number
     decision_count: number
     latest_decision: string | null
   }

   export interface Decision {
     id: string
     decision_statement: string
     who: string
     timestamp: string
     discipline: string
     meeting_type: string
     meeting_date: string
     why: string
     causation: string
     impacts: Impact[]
     consensus: Record<string, string>
     confidence: number
     anomaly_flags: AnomalyFlag[]
     created_at: string
   }

   export interface Impact {
     type: 'timeline' | 'budget' | 'scope'
     change: string
   }

   export interface AnomalyFlag {
     type: string
     severity: 'low' | 'medium' | 'high'
     description: string
   }
   ```

3. **Create utility functions (`src/lib/utils.ts`)**
   ```typescript
   import { type ClassValue, clsx } from "clsx"
   import { twMerge } from "tailwind-merge"

   export function cn(...inputs: ClassValue[]) {
     return twMerge(clsx(inputs))
   }

   export function formatDate(date: string): string {
     return new Date(date).toLocaleDateString('en-US', {
       year: 'numeric',
       month: 'short',
       day: 'numeric'
     })
   }
   ```

### Task 4: Configure React Query and Routing (0.5 days)

1. **Setup React Query Provider (`src/App.tsx`)**
   ```typescript
   import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
   import { BrowserRouter } from 'react-router-dom'
   import { Router } from './Router'

   const queryClient = new QueryClient({
     defaultOptions: {
       queries: {
         refetchOnWindowFocus: false,
         retry: 1,
         staleTime: 5 * 60 * 1000, // 5 minutes
       },
     },
   })

   function App() {
     return (
       <QueryClientProvider client={queryClient}>
         <BrowserRouter>
           <Router />
         </BrowserRouter>
       </QueryClientProvider>
     )
   }

   export default App
   ```

2. **Create Router (`src/Router.tsx`)**
   ```typescript
   import { Routes, Route, Navigate } from 'react-router-dom'
   import { LoginPage } from './pages/Login'
   import { ProjectsPage } from './pages/Projects'
   import { ProjectDetailPage } from './pages/ProjectDetail'

   export function Router() {
     return (
       <Routes>
         <Route path="/login" element={<LoginPage />} />
         <Route path="/projects" element={<ProjectsPage />} />
         <Route path="/projects/:id" element={<ProjectDetailPage />} />
         <Route path="/" element={<Navigate to="/projects" replace />} />
       </Routes>
     )
   }
   ```

3. **Create Zustand store (`src/store/authStore.ts`)**
   ```typescript
   import { create } from 'zustand'
   import { User } from '../types'

   interface AuthState {
     user: User | null
     isAuthenticated: boolean
     setUser: (user: User | null) => void
     logout: () => void
   }

   export const useAuthStore = create<AuthState>((set) => ({
     user: null,
     isAuthenticated: false,
     setUser: (user) => set({ user, isAuthenticated: !!user }),
     logout: () => set({ user: null, isAuthenticated: false }),
   }))
   ```

### Task 5: Configure Environment and Scripts (0.25 days)

1. **Create `.env.example`**
   ```env
   VITE_API_URL=http://localhost:8000/api
   VITE_APP_NAME=DecisionLog
   ```

2. **Update `package.json` scripts**
   ```json
   {
     "scripts": {
       "dev": "vite",
       "build": "tsc && vite build",
       "preview": "vite preview",
       "typecheck": "tsc --noEmit",
       "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
       "test": "vitest"
     }
   }
   ```

3. **Create ESLint config (`.eslintrc.cjs`)**
   ```javascript
   module.exports = {
     root: true,
     env: { browser: true, es2020: true },
     extends: [
       'eslint:recommended',
       'plugin:@typescript-eslint/recommended',
       'plugin:react-hooks/recommended',
     ],
     ignorePatterns: ['dist', '.eslintrc.cjs'],
     parser: '@typescript-eslint/parser',
     plugins: ['react-refresh'],
     rules: {
       'react-refresh/only-export-components': [
         'warn',
         { allowConstantExport: true },
       ],
     },
   }
   ```

---

## Dev Notes

### Project Structure

```
decision-log-frontend/
├── src/
│   ├── components/       # Reusable UI components
│   │   ├── Timeline.tsx
│   │   ├── DecisionCard.tsx
│   │   ├── Filters.tsx
│   │   └── DrillDown.tsx
│   ├── pages/            # Page-level components
│   │   ├── Login.tsx
│   │   ├── Projects.tsx
│   │   └── ProjectDetail.tsx
│   ├── hooks/            # Custom React hooks
│   │   ├── useAuth.ts
│   │   ├── useProjects.ts
│   │   └── useDecisions.ts
│   ├── services/         # API service layer
│   │   └── api.ts
│   ├── store/            # Zustand state
│   │   ├── authStore.ts
│   │   └── filterStore.ts
│   ├── types/            # TypeScript types
│   │   └── index.ts
│   ├── lib/              # Utilities
│   │   └── utils.ts
│   ├── App.tsx
│   ├── Router.tsx
│   ├── main.tsx
│   └── index.css
├── public/
├── .env.example
├── package.json
├── vite.config.ts
├── tsconfig.json
├── tailwind.config.ts
└── README.md
```

### Tech Stack

| Technology | Version | Purpose |
|-----------|---------|---------|
| React | 18.x | UI library |
| TypeScript | 5.x | Type safety |
| Vite | 5.x | Build tool |
| React Router | 6.x | Routing |
| React Query | 5.x | Data fetching |
| Zustand | 4.x | State management |
| Tailwind CSS | 3.x | Styling |
| Shadcn/ui | latest | Component library |
| Axios | 1.x | HTTP client |

---

## File List

**Modified/Created:**
- `package.json` (new)
- `vite.config.ts` (new)
- `tsconfig.json` (new)
- `tailwind.config.ts` (new)
- `.eslintrc.cjs` (new)
- `src/App.tsx` (new)
- `src/Router.tsx` (new)
- `src/types/index.ts` (new)
- `src/store/authStore.ts` (new)
- `src/lib/utils.ts` (new)
- `.env.example` (new)

---

## Testing Strategy

### Setup Verification Tests

```typescript
// tests/setup.test.tsx
import { describe, it, expect } from 'vitest'
import { render } from '@testing-library/react'
import App from '../src/App'

describe('Project Setup', () => {
  it('renders without crashing', () => {
    const { container } = render(<App />)
    expect(container).toBeTruthy()
  })

  it('has TypeScript configured', () => {
    const num: number = 42
    expect(typeof num).toBe('number')
  })
})
```

### Build Tests

```bash
# TypeScript check
npm run typecheck  # Should pass with no errors

# Lint check
npm run lint  # Should pass with no warnings

# Build check
npm run build  # Should create dist/ folder

# Dev server
npm run dev  # Should start on localhost:5173
```

---

## Change Log

| Date | Change |
|------|--------|
| 2026-02-08 | Created story |

---

**Related Stories:** 3.2 (API Service Layer), 3.3 (Authentication)
**Blocked By:** None
**Blocks:** 3.2, 3.3, 3.4 (all frontend stories)
